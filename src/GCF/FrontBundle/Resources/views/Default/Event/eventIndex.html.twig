{% extends '@GCFFront/base.html.twig' %}


{% block title %} GCF - {{ 'menu.Events'|trans }} {% endblock %}


{% block stylesheets %}
    <style>
        .event__banner__container{
            margin-bottom: 20px;
        }
        .event__banner{
            max-height: 100%;
            height: 140px;
            background-size:cover;
            background-repeat: no-repeat;
            border-bottom: solid 2px white;

        }
        .event__img__info{
            background: #ccc;
            display:flex;
            min-height:  140px;
            padding-bottom: 1px;

        }
        .event__img img{
            margin-top: -20px;
            max-height: 100px;
            border: solid 2px white;
        }
        .event__info h3.event__info__title{
            margin-top: 10px;
            font-size: 15px;
            cursor: pointer;

        }
        .event__info h3.event__info__title a{
            text-decoration: none;
            color: inherit;
        }
        .event__info h3.event__info__title a:hover{
            color: #22aa86;
            text-decoration: none;
        }

        .event__info p.event__info__date i{
            width: 20px;
            font-size: 13px;
        }
        .event__info p.event__info__time i{
            width: 20px;
            font-size: 13px;
        }

        .event__info p.event__info__place{

        }
        .event__info p.event__info__place i{
            width: 20px;
            font-size: 13px;
        }
        .event__info p.event__info__fb{
            text-align: right;
        }
        .event__info .event__info__fb i{
            width: 25px;
            padding: 5px;
            font-size: 15px;
            text-align: center;
            text-decoration: none;
            background: white;
            color: #22AA86;
            border-radius: 50%;
        }

        /*
        ==================
              POPUP
        ==================
        */
        .popup__container{
            display: none;
            position: fixed;
            z-index: 9999;
            margin: auto;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            width: 600px;
            max-width: 100%;
            min-height: 350px;
            height: max-content;
            background-color: white;
            box-shadow: 0px 0px  5px 5px rgba(255, 255, 255, 0.15);
        }
        .popup__container .close_popup{
            position: absolute;
            top: -10px;
            right: -12px;
            color: red;
            cursor: pointer;
            line-height: 24px;
            font-weight: 600;
            background: white;
            border-radius: 50%;
        }

        .popup__container.active{
            display:block;

        }
        .popup__overlay{
            position: fixed;
            z-index: 9998;
            display: none;
            top: 0;
            bottom: 0;
            right: 0;
            left: 0;
            background-color: rgba(0,0,0,0.4);
        }
        .popup__overlay button{
            float: right;
            margin: 20px;
            font-size: 30px;
            background: transparent;
            border: none;
            color: white;
            font-weight: 700;
            outline:none;
        }

        .popup__header{
            min-height: 200px;
            max-height: 200px;
            background-size: cover;
            background-repeat: no-repeat;
            width: 100%;
            border-bottom: solid 2px #22aa86;
            background-color: grey;
        }

        .popup__body__title h2{
            font-size: 20px;
            font-weight: 600;
        }
        .popup__body__content h3 {
            margin-top: 0;
        }
        .popup__footer__facebook{
            float: right;
            text-decoration: none;
        }
        .popup__footer__facebook i{
            border-radius: 50%;
            border: solid 1px;
            width: 25px;
            height: 25px;
            text-align: center;
            line-height: 24px;
        }

        .popup__footer__others{text-align: left}
        .popup__footer__others:hover ,.popup__footer__others:focus, .popup__footer__others:active{text-decoration:none}

    </style>
{% endblock %}

{% block body %}

    <div class="col-md-12">
        {% for evenement in evenements %}
            <div class="col-md-6 col-sm-6 event__banner__container">

                <div class="event__banner" style="background-image: url('{{ evenement.photoCouverture|replace({'app_dev.php': ''})  }}');">
                </div>

                <div class="event__img__info">
                    <div class="event__info col-md-12 col-sm-12 col-xs-12">
                        <h3 class="event__info__title" onclick="toggle_popup({{ evenement.id }})"><a href="{{ path('gcf_front_single_event_page', {'slug': evenement.nom|lower|replace({' ': '-'})}) }}" >{{ evenement.nom }}</a></h3>
                        <p class="event__info__place"><i class="fa fa-map-marker" aria-hidden="true"></i>{{ evenement.lieu }} </p>
                        <p class="event__info__date"><i class="fa fa-calendar" aria-hidden="true"></i>{{ evenement.debut|date("d-m-Y") }}</p>
                        <p class="event__info__time"><i class="fa fa-clock-o" aria-hidden="true"></i>{{ evenement.debut|date("g:ia")}} - {{ evenement.fin|date("g:ia")}}</p>
                        <p class="event__info__fb"><a href="href="{{ path('gcf_front_single_event_page', {'slug': evenement.nom|lower|replace({' ': '-'})}) }}"" title="Facebook" target="_blank">
                            <i class="fa fa-facebook " aria-hidden="true" style="border-radius: 50%"></i>
                        </a></p>
                    </div>

                </div>

            </div>
        {% endfor %}
    </div>


    <div class="popup__container">
        <i class="fa fa-times-circle fa-2x close_popup" aria-hidden="true" onclick="closePopup()"></i>
        <div class="popup__header"></div>
        <div class="popup__body">
            <div class="popup__body__head col-xs-12">
                <div class="popup__body__title"><h2></h2></div>
            </div>
            <div class="popup__body__content col-xs-12">
                <h3></h3>
                <p></p>
            </div>
            <div class="popup__footer col-xs-12">
                <p>
                    <a class="popup__footer__others" href="" title="Event" target="_blank">
                        Event Link
                    </a>

                    <a class="popup__footer__facebook" href="" title="Facebook" target="_blank">
                        <i class="fa fa-facebook " aria-hidden="true" style="border-radius: 50%"></i>
                    </a>
                </p>
            </div>

        </div>
    </div>
    <div class="popup__overlay" onclick="closePopup()">
    </div>
{% endblock %}

{% block javascripts %}
    <script  type="text/javascript" charset="utf-8">
        function toggle_popup(event_id) {



            url = '{{ path('gcf_front_single_event', {'id': 'id'} ) }}';
            url = url.replace("id", event_id);

            $.ajax({
                url: url,
                type: 'POST',
                data: { 'id' : event_id },
                dataType: 'json',
                contentType: 'application/json',
                success: function (result) {
                    $('.popup__overlay').css('display', 'block');
                    $('.popup__container').addClass('active');

                    console.log(result);

                    $('.popup__header').css('background-image', 'url("'+result.banner.replace('app_dev.php/', '')+'")' );

                    $('.popup__body__title h2').html( result.name );

                    var date = result.date.date.substr(0, 10);
                    var time = result.date.date.substr(11, 5);

                    $('.popup__body__content h3').html( 'Le '+date+' Ã  partir de '+time );

                    $('.popup__body__content p').html( result.description );

                    $('.popup__footer a.popup__footer__facebook').attr('href', result.linkFB);

                    $('.popup__footer a.popup__footer__others').attr('href', result.linkOthers);

                },
                error: function(error){
                    console.log(error);
                }
            });
        }
        function closePopup(){
            $('.popup__container').removeClass('active');
            $('.popup__overlay').css('display', 'none');
        }
    </script>
{% endblock %}